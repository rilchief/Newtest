<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Afrobeats Playlist Gatekeeping Observatory</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="data/scripts/style.css" />
</head>
<body>
  <a href="#dashboard-main" class="skip-link">Skip to dashboard</a>
  <header>
    <h1>Afrobeats Playlist Gatekeeping Observatory</h1>
    <p>
      Explore how Spotify playlists shape the global identity of Afrobeats. Benchmark regional representation,
      curator influence, and sonic diversity across influential playlists to surface signals of gatekeeping and bias.
    </p>
    <div class="hero-actions">
      <a class="cta" href="data/scripts/data.js" download>Download current snapshot</a>
      <a class="cta secondary" href="README.md">Project notes</a>
      <a class="cta secondary" href="scripts/fetch_spotify_data.py">Regenerate data</a>
    </div>
  </header>

  <section class="panel status-strip page-block" aria-label="Dataset status">
    <div class="status-metrics">
      <div>
        <span class="status-label">Generated</span>
        <strong id="data-generated">--</strong>
      </div>
      <div>
        <span class="status-label">Ingestion started</span>
        <strong id="data-started">--</strong>
      </div>
      <div>
        <span class="status-label">Playlists captured</span>
        <strong id="dataset-playlist-count">--</strong>
      </div>
      <div>
        <span class="status-label">Artists missing metadata</span>
        <strong id="dataset-missing-count">--</strong>
      </div>
    </div>
    <div class="status-note">
      <span class="status-label">Audio features</span>
      <span id="audio-feature-status" class="status-pill">Checking coverageâ€¦</span>
    </div>
  </section>

  <main id="dashboard-main">
    <aside id="filters" class="panel" aria-label="Dashboard filters">
      <div class="filter-group">
        <h3>Search playlist</h3>
        <input type="search" id="search" placeholder="Type a playlist name" aria-label="Search playlists" />
      </div>

      <div class="filter-group">
        <h3>Curator type</h3>
        <div id="curator-types" class="checkbox-list"></div>
      </div>

      <div class="filter-group">
        <h3>Release year range</h3>
        <label>
          From
          <input type="number" id="min-year" min="2005" max="2030" step="1" />
        </label>
        <label>
          To
          <input type="number" id="max-year" min="2005" max="2030" step="1" />
        </label>
      </div>

      <div class="filter-group">
        <h3>Diaspora focus</h3>
        <label>
          <input type="checkbox" id="diaspora-only" /> Highlight diaspora-led tracks
        </label>
      </div>

      <button id="reset-filters" type="button">Reset filters</button>
    </aside>

    <section class="dashboard-grid">
      <section class="cards" aria-label="Key metrics">
        <article class="card">
          <h4>Playlists analysed</h4>
          <strong id="playlist-count">0</strong>
          <span class="card-subtitle">after filters</span>
        </article>
        <article class="card">
          <h4>Tracks analysed</h4>
          <strong id="track-count">0</strong>
          <span class="card-subtitle">unique recordings</span>
        </article>
        <article class="card">
          <h4>Nigeria share</h4>
          <strong id="nigeria-share">0%</strong>
          <span class="card-subtitle">of tracks</span>
        </article>
        <article class="card">
          <h4>Diaspora representation</h4>
          <strong id="diaspora-share">0%</strong>
          <span class="card-subtitle">of tracks</span>
        </article>
        <article class="card">
          <h4>Regional diversity</h4>
          <strong id="diversity-score">0</strong>
          <span class="card-subtitle">avg. unique regions per playlist</span>
        </article>
      </section>

      <section class="visualisation" aria-label="Charts">
        <article class="chart-panel">
          <div>
            <h3>Regional representation</h3>
            <p>Distribution of artist origins across the filtered playlists. Hover to inspect counts.</p>
          </div>
          <canvas id="region-chart" aria-label="Regional representation chart" role="img"></canvas>
        </article>
        <article class="chart-panel">
          <div>
            <h3>Audio profile</h3>
            <p>
              Mean danceability, energy, valence, tempo, and acousticness for the filtered selection. Requires Spotify
              audio feature access.
            </p>
          </div>
          <div id="audio-status-banner" class="chart-banner" role="status" hidden>
            Audio features are currently unavailable; radar values default to zero until coverage improves.
          </div>
          <canvas id="audio-chart" aria-label="Audio profile radar" role="img"></canvas>
        </article>
        <article class="chart-panel">
          <div>
            <h3>Curator concentration</h3>
            <p>Share of Nigerian artists per curator category. Lower values signal broader regional coverage.</p>
          </div>
          <canvas id="curator-chart" aria-label="Curator concentration chart" role="img"></canvas>
        </article>
      </section>

      <section class="panel" aria-label="Playlist breakdown">
        <div class="panel-heading">
          <h2>Playlist breakdown</h2>
          <p>
            Compare reach, regional diversity, and diaspora visibility. Metrics reflect the current filter selection.
          </p>
        </div>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Playlist</th>
                <th>Curator</th>
                <th>Followers</th>
                <th>Unique regions</th>
                <th>Diaspora share</th>
                <th>Nigeria share</th>
                <th>Energy</th>
                <th>Danceability</th>
              </tr>
            </thead>
            <tbody id="playlist-table"></tbody>
          </table>
        </div>
        <div id="empty-state" class="empty-state" hidden>
          No playlists match the filters. Adjust the search to see results.
        </div>
      </section>
    </section>
  </main>

  <section class="panel methodology page-block" aria-label="How to interpret this dashboard">
    <h2>How to use this observatory</h2>
    <ul>
      <li><strong>Filter the inputs</strong>: Narrow curators, year range, or diaspora focus to mirror specific research questions.</li>
      <li><strong>Inspect imbalances</strong>: Scan the cards and charts for over-indexing by region or curator type.</li>
      <li><strong>Validate metadata</strong>: Keep the artist CSV aligned with new playlists so regional insights remain trustworthy.</li>
      <li><strong>Refresh frequently</strong>: Run <code>python scripts/fetch_spotify_data.py</code> after updating playlist IDs or artist metadata.</li>
    </ul>
  </section>

  <footer>
    Data synthesised from Spotify playlists for prototyping only. Replace <code>data.js</code> with live API output for
    production research. Methods reference research into algorithmic gatekeeping.
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js" defer></script>
  <script src="data/scripts/data.js" defer></script>
  <script src="data/scripts/app.js" defer></script>
</body>
</html>
